from datetime import datetime


# Get current date in a readable format
def get_current_date():
    return datetime.now().strftime("%B %d, %Y")


query_writer_instructions = """您的目标是生成复杂且多样的网页搜索查询。这些查询旨在用于一个先进的自动化网页研究工具，该工具能够分析复杂的结果、跟踪链接并综合信息。

指令:
- 始终优先选择单个搜索查询，仅当原始问题请求多个方面或元素且一个查询不足时才添加另一个查询。
- 每个查询应专注于原始问题的特定方面。
- 不要生成超过 {number_queries} 个查询。
- 查询应该多样化，如果主题广泛，则生成多个查询。
- 不要生成多个相似的查询，1个就足够了。
- 查询应确保收集到最新的信息。当前日期是 {current_date}。

格式: 
- 将您的响应格式化为具有以下所有三个确切键的 JSON 对象:
   - "rationale": 简要解释为什么这些查询是相关的
   - "query": 搜索查询列表

示例:

主题: 去年苹果股票的收入增长与购买iPhone的人数增长哪个更多
```json
{{
    "rationale": "为了准确回答这个比较增长的问题，我们需要关于苹果股票表现和iPhone销售指标的具体数据点。这些查询针对所需的精确财务信息：公司收入趋势、特定产品的单位销售数据以及同一财政年度的股价变动以进行直接比较。",
    "query": ["苹果2024财年总收入增长", "iPhone 2024财年单位销售增长", "苹果2024财年股价增长"],
}}
```

上下文: {research_topic}"""


web_searcher_instructions = """进行有针对性的谷歌搜索，以收集关于"{research_topic}"的最新、可信的信息，并将其综合成一个可验证的文本工件。

指令:
- 查询应确保收集到最新的信息。当前日期是 {current_date}。
- 进行多次、多样化的搜索以收集全面的信息。
- 整合关键发现，同时为每条具体信息精心跟踪来源。
- 输出应是基于您的搜索发现的撰写良好的摘要或报告。
- 只包括搜索结果中找到的信息，不要编造任何信息。

研究主题:
{research_topic}
"""

reflection_instructions = """您是一位正在分析关于"{research_topic}"的摘要的专家研究助理。

指令:
- 识别知识差距或需要更深入探索的领域，并生成一个后续查询（1个或多个）。
- 如果提供的摘要足以回答用户的问题，则不要生成后续查询。
- 如果存在知识差距，生成一个有助于扩展您理解的后续查询。
- 关注技术细节、实施细节或未完全涵盖的新兴趋势。

要求:
- 确保后续查询是独立的，并包含进行网页搜索所需的上下文。

输出格式:
- 将您的响应格式化为具有以下确切键的 JSON 对象:
   - "is_sufficient": true 或 false
   - "knowledge_gap": 描述缺少或需要澄清的信息
   - "follow_up_queries": 编写一个具体问题来解决这个差距

示例:
```json
{{
    "is_sufficient": true, // 或 false
    "knowledge_gap": "摘要缺少关于性能指标和基准的信息", // 如果 is_sufficient 为 true，则为 ""
    "follow_up_queries": ["评估[特定技术]时通常使用哪些性能基准和指标？"] // 如果 is_sufficient 为 true，则为 []
}}
```

仔细反思摘要以识别知识差距并生成后续查询。然后，按照以下 JSON 格式生成您的输出:

摘要:
{summaries}
"""

answer_instructions = """根据提供的摘要为用户的问题生成高质量的答案。

指令:
- 当前日期是 {current_date}。
- 您是多步骤研究过程的最后一步，不要提及您是最后一步。
- 您可以访问从先前步骤收集的所有信息。
- 您可以访问用户的问题。
- 根据提供的摘要和用户的问题，为用户的问题生成高质量的答案。
- 您必须在答案中正确包含摘要中的所有引文。
- 请务必使用中文回答。

用户上下文:
- {research_topic}

摘要:
{summaries}"""
